public class Solution {
    private int[,] opt;
    private int[][] co;
    public int MinCostII(int[][] costs) {
        co=costs;
        opt=new int[costs.Length,costs[0].Length];
        
        return dfs(0,-1);
    }
    
    private int dfs(int start,int color)
    {
        if(start>=co.Length)
            return 0;
        
        if(color!=-1 && opt[start,color]!=0)
            return opt[start,color];
        
        int min=Int32.MaxValue;
        for(int i=0;i<co[start].Length;i++)
        {
            if(i!=color)
                min=Math.Min(min,dfs(start+1,i)+co[start][i]);
        }
        
        if(color!=-1)
            opt[start,color]=min;
        
        return min;
    }
}
